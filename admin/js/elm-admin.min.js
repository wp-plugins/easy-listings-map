(function(a){a(function(){var b={init:function(){this.general()},general:function(){if(typeof wp=="undefined"){if(a(".elm_settings_upload_button").length>0){window.formfield="";a("body").on("click",".elm_settings_upload_button",function(d){d.preventDefault();window.formfield=a(this).parent().prev();window.tbframe_interval=setInterval(function(){jQuery("#TB_iframeContent").contents().find(".savesend .button").val(elm_vars.use_this_file).end().find("#insert-gallery, .wp-post-thumbnail").hide()},2000);tb_show(elm_vars.add_new_download,"media-upload.php?referrer_page=elm-settings&TB_iframe=true")});window.edd_send_to_editor=window.send_to_editor;window.send_to_editor=function(e){if(window.formfield){var d=a("a","<div>"+e+"</div>").attr("href");window.formfield.val(d);window.clearInterval(window.tbframe_interval);tb_remove()}else{window.edd_send_to_editor(e)}window.send_to_editor=window.edd_send_to_editor;window.formfield="";window.imagefield=false}}}else{var c;window.formfield="";a("body").on("click",".elm_settings_upload_button",function(f){f.preventDefault();var d=a(this);window.formfield=a(this).parent().prev();if(c){c.open();return}c=wp.media.frames.file_frame=wp.media({frame:"post",state:"insert",title:d.data("uploader_title"),button:{text:d.data("uploader_button_text")},multiple:false});c.on("menu:render:default",function(g){var e={};g.unset("library-separator");g.unset("gallery");g.unset("featured-image");g.unset("embed");g.set(e)});c.on("insert",function(){var e=c.state().get("selection");e.each(function(h,g){h=h.toJSON();window.formfield.val(h.url)})});c.on("ready",function(){c.uploader.options.uploader.params={referrer_page:"elm-settings"}});c.open()})}}};b.init();jQuery(".help_tip").tipTip({attribute:"data-tip",fadeIn:50,fadeOut:50,delay:200})})})(jQuery);
